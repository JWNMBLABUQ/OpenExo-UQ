<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Adding New Sensors &#8212; OpenExo Documentation 0.1-dev documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=75810a84" />
    <link rel="stylesheet" type="text/css" href="_static/material.css?v=79c92029" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <script src="_static/jquery.js?v=5d32c60e"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="_static/documentation_options.js?v=4f578d93"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Adding New UART Messages" href="AddingNewUARTMessage.html" />
    <link rel="prev" title="Adding a New Motor Type" href="AddingNewMotorType.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=blue-grey data-md-color-accent=blue>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#AddingNewSensors" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="index.html" title="OpenExo Documentation 0.1-dev documentation"
           class="md-header-nav__button md-logo">
          
            &nbsp;
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">OpenExo Documentation 0.1-dev documentation</span>
          <span class="md-header-nav__topic"> Adding New Sensors </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder=""Search""
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
      
  
  <script src="_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = ""versions.json"",
        target_loc = "../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="index.html" class="md-tabs__link">OpenExo Documentation 0.1-dev documentation</a></li>
          <li class="md-tabs__item"><a href="addingelements.html" class="md-tabs__link">Adding Elements</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="index.html" title="OpenExo Documentation 0.1-dev documentation" class="md-nav__button md-logo">
      
        <img src="_static/" alt=" logo" width="48" height="48">
      
    </a>
    <a href="index.html"
       title="OpenExo Documentation 0.1-dev documentation">OpenExo Documentation 0.1-dev documentation</a>
  </label>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">"Contents"</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#addingnewsensors--page-root" class="md-nav__link">Adding New Sensors</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#overview" class="md-nav__link">Overview</a>
        </li>
        <li class="md-nav__item"><a href="#analog-input" class="md-nav__link">Analog Input</a>
        </li>
        <li class="md-nav__item"><a href="#bus-protocols" class="md-nav__link">Bus Protocols</a>
        </li>
        <li class="md-nav__item"><a href="#integrating-new-sensors-into-the-codebase" class="md-nav__link">Integrating New Sensors into the Codebase</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="_sources/AddingNewSensors.rst.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="adding-new-sensors">
<h1 id="addingnewsensors--page-root">Adding New Sensors<a class="headerlink" href="#addingnewsensors--page-root" title="Link to this heading"></a></h1>
<section id="overview">
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>In our codebase, sensor integration varies depending on the sensor. Below are examples of sensors that have been tested or integrated and are compatible with our platform:</p>
<ul class="simple">
<li><p><strong>Analog input</strong>
- Force sensitive resistor
- Torque sensor (strain gauge)
- Angle sensor (AS5600; hall effect)</p></li>
<li><p><strong>Bus protocol</strong>
- I2C (Teensy-Nano communication)
- UART (Teensy-Nano communication)
- CAN (Teensy-Motor communication)
- SPI (Teensy-SD Card interface)</p></li>
</ul>
<p>Here, we demonstrate how the Teensy communicates with sensors using an example for an analog input sensor and another for the I2C protocol.</p>
</section>
<hr class="docutils"/>
<section id="analog-input">
<h2 id="analog-input">Analog Input<a class="headerlink" href="#analog-input" title="Link to this heading"></a></h2>
<p>For an analog sensor—such as the torque sensor used for exoskeleton torque feedback control—the fundamental operation uses <code class="docutils literal notranslate"><span class="pre">analogRead()</span></code> on the sensor’s signal pin to retrieve its value (or an amplified version):</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">float</span><span class="w"> </span><span class="n">current_reading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">analogRead</span><span class="p">(</span><span class="n">_pin</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">torque_calibration</span><span class="o">::</span><span class="n">AI_CNT_TO_V</span><span class="p">;</span>
</pre></div>
</div>
<p><strong>Notes from PJRC:</strong>
- None of the pins on the Teensy are 5-volt tolerant; the input voltage range is fixed at 0 to 3.3 volts.
- <code class="docutils literal notranslate"><span class="pre">analogReference()</span></code> has no effect on the Teensy 4.1.</p>
<p><em>Sidenote:</em>
If you need to use <code class="docutils literal notranslate"><span class="pre">digitalRead()</span></code>, ensure you set the proper pin mode using <code class="docutils literal notranslate"><span class="pre">pinMode()</span></code>, such as <code class="docutils literal notranslate"><span class="pre">INPUT</span></code> or <code class="docutils literal notranslate"><span class="pre">INPUT_PULLUP</span></code>. Refer to the sensor or peripheral user manual for guidance.</p>
<p><strong>More examples on ``analogRead()``:</strong>
The following files utilize <code class="docutils literal notranslate"><span class="pre">analogRead()</span></code>:
- <code class="docutils literal notranslate"><span class="pre">AnkleAngles.cpp</span></code>
- <code class="docutils literal notranslate"><span class="pre">FSR.cpp</span></code>
- <code class="docutils literal notranslate"><span class="pre">TorqueSensor.cpp</span></code></p>
<p><strong>Available Analog Pins:</strong>
If you are using our reference PCB, consult the PCB design documentation for the list of available analog pins. Stacking headers for Teensy 4.1 can also be used to improve access.</p>
</section>
<hr class="docutils"/>
<section id="bus-protocols">
<h2 id="bus-protocols">Bus Protocols<a class="headerlink" href="#bus-protocols" title="Link to this heading"></a></h2>
<p>Unlike analog signals, bus protocols provide a highway for digital signals, enabling faster data transmission at higher frequencies.
A comparison of the protocols used in our codebase can be found here:
<a class="reference external" href="https://www.totalphase.com/blog/2021/12/i2c-vs-spi-vs-uart-introduction-and-comparison-similarities-differences/">I2C vs SPI vs UART</a></p>
<p>### I2C in Our Codebase—A Detailed Example
Noah Enlow has put together excellent documentation on I2C in our codebase. Below is a step-by-step example of sending float data over I2C using a union.</p>
<ol class="arabic">
<li><p><strong>Define the Union on the Sending Device</strong>
This union allows you to access the same raw data as a float or as bytes.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">union</span><span class="w"> </span><span class="nc">Data</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">data_as_float</span><span class="p">;</span><span class="w">        </span><span class="c1">// Float representation</span>
<span class="w">    </span><span class="n">byte</span><span class="w"> </span><span class="n">data_as_bytes</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span><span class="w">      </span><span class="c1">// Byte vector (floats are 4 bytes)</span>
<span class="p">};</span>
</pre></div>
</div>
</li>
<li><p><strong>Store the Data to Send</strong></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">Data</span><span class="p">.</span><span class="n">data_as_float</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data_to_be_sent</span><span class="p">;</span>
</pre></div>
</div>
</li>
<li><p><strong>Send Data via I2C Using the Wire Library</strong></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">sendEvent</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Wire</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">Data</span><span class="p">.</span><span class="n">data_as_bytes</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">Data</span><span class="p">.</span><span class="n">data_as_bytes</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p><strong>Receiving the Data on the Primary Device</strong></p>
<ol class="arabic">
<li><p>Define an identical union:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">union</span><span class="w"> </span><span class="nc">Data</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">data_as_float</span><span class="p">;</span>
<span class="w">    </span><span class="n">byte</span><span class="w"> </span><span class="n">data_as_bytes</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
<span class="p">};</span>
</pre></div>
</div>
</li>
<li><p>Request the data from the peripheral:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">Wire</span><span class="p">.</span><span class="n">requestFrom</span><span class="p">(</span><span class="n">PERIPHERAL_ADDRESS</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Data</span><span class="p">.</span><span class="n">data_as_bytes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Wire</span><span class="p">.</span><span class="n">read</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p>Convert the received bytes back to a float:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">float</span><span class="w"> </span><span class="n">data_received</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Data</span><span class="p">.</span><span class="n">data_as_float</span><span class="p">;</span>
</pre></div>
</div>
</li>
</ol>
</li>
</ol>
<p>In summary, the process is:</p>
<p>float -&gt; convert to bytes -&gt; send over I2C -&gt; receive as bytes -&gt; convert back to float</p>
<p><strong>More Examples on Bus Protocols:</strong></p>
<ul class="simple">
<li><p>Files using <strong>I2C</strong>:
- <code class="docutils literal notranslate"><span class="pre">Battery.cpp</span></code>
- <code class="docutils literal notranslate"><span class="pre">I2CHandler.h</span></code>
- <code class="docutils literal notranslate"><span class="pre">RealTimeI2C.cpp</span></code>
- <code class="docutils literal notranslate"><span class="pre">ThIMU.h</span></code></p></li>
<li><p>Files using <strong>SPI</strong>:
- <code class="docutils literal notranslate"><span class="pre">ParamsFromSD.cpp</span></code></p></li>
<li><p>Files using <strong>UART</strong>:
- <code class="docutils literal notranslate"><span class="pre">ble_commands.h</span></code>
- <code class="docutils literal notranslate"><span class="pre">ComsMCU.cpp</span></code> and <code class="docutils literal notranslate"><span class="pre">ComsMCU.h</span></code>
- <code class="docutils literal notranslate"><span class="pre">ErrorReporter.h</span></code>
- <code class="docutils literal notranslate"><span class="pre">Exo.cpp</span></code>
- <code class="docutils literal notranslate"><span class="pre">uart_commands.h</span></code>
- <code class="docutils literal notranslate"><span class="pre">UARTHandler.cpp</span></code></p></li>
<li><p>Files using <strong>CAN</strong>:
- <code class="docutils literal notranslate"><span class="pre">CAN.h</span></code>
- <code class="docutils literal notranslate"><span class="pre">Motor.cpp</span></code></p></li>
</ul>
<p><strong>Available Pins for Bus Protocols:</strong>
Check your reference PCB documentation for the list of available pins. Stacking headers on the Teensy 4.1 can also improve access.</p>
</section>
<hr class="docutils"/>
<section id="integrating-new-sensors-into-the-codebase">
<h2 id="integrating-new-sensors-into-the-codebase">Integrating New Sensors into the Codebase<a class="headerlink" href="#integrating-new-sensors-into-the-codebase" title="Link to this heading"></a></h2>
<p>To ensure that sensor readings are accessible across the system, follow these procedures to embed your new sensor.</p>
<p>### Location – Where Should I Write the Sensor Code?
Due to the lack of a common sensor interface, decide where the sensor code best fits within the system architecture (e.g., exo, side, or joint level).</p>
<p>### Create the Sensor
Develop a sensor as its own class by creating corresponding <code class="docutils literal notranslate"><span class="pre">.h</span></code> and <code class="docutils literal notranslate"><span class="pre">.cpp</span></code> files in the <strong>src</strong> folder. Below is an outline for the sensor header file:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">CLASS_NAME</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">public</span><span class="o">:</span>
<span class="w">        </span><span class="c1">// Constructor: may include a pin parameter if using an analog input</span>
<span class="w">        </span><span class="n">CLASS_NAME</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">pin</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// Checks if the sensor needs calibration and returns whether calibration is complete</span>
<span class="w">        </span><span class="kt">bool</span><span class="w"> </span><span class="nf">calibrate</span><span class="p">(</span><span class="kt">bool</span><span class="w"> </span><span class="n">do_calibrate</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// Reads the sensor and returns its value; for multiple returns, use pointers</span>
<span class="w">        </span><span class="kt">float</span><span class="w"> </span><span class="nf">read</span><span class="p">();</span>

<span class="w">    </span><span class="k">private</span><span class="o">:</span>
<span class="w">        </span><span class="c1">// A sample private function (implementation will vary)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="n">_sample_function</span><span class="p">();</span>

<span class="w">        </span><span class="c1">// The pin to which the sensor is connected</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">_pin</span><span class="p">;</span>

<span class="w">        </span><span class="c1">// A private variable for sensor data (example)</span>
<span class="w">        </span><span class="kt">float</span><span class="w"> </span><span class="n">_sample_var</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
<p>### Migrating to the Main Code</p>
<p>#### Board.h
For each board that will use the sensor, define the pin(s) that each sensor will use. For analog sensors, define four pins if four sensors are employed (adapt for other types as needed). Ensure that the chosen pin is free; planning your PCB layout beforehand facilitates this.</p>
<p>#### System Containing Sensor Data (.h)
Create variables in the appropriate data-holding class (e.g., <code class="docutils literal notranslate"><span class="pre">SideData</span></code> or <code class="docutils literal notranslate"><span class="pre">JointData</span></code>) to store sensor readings and calibration status. For example:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">float</span><span class="w"> </span><span class="n">sensor_reading</span><span class="p">;</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">sensor_calibrate</span><span class="p">;</span>
</pre></div>
</div>
<p>#### System Containing Sensor Data (.cpp)
In the constructor for the corresponding data class, initialize these variables (often to 0 or false):</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">sensor_reading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">sensor_calibrate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
</pre></div>
</div>
<p>#### System Containing Sensor.h
If the sensor is at the side level, include the sensor header in <code class="docutils literal notranslate"><span class="pre">Side.h</span></code>; if at the joint level, in <code class="docutils literal notranslate"><span class="pre">Joint.h</span></code>. Then, declare an instance of your sensor class:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">"Sensor.h"</span>
<span class="c1">// Within the class declaration:</span>
<span class="n">SensorClass</span><span class="w"> </span><span class="n">new_instance_of_sensor</span><span class="p">;</span>
</pre></div>
</div>
<p>#### System Containing Sensor.cpp
Within the corresponding <code class="docutils literal notranslate"><span class="pre">.cpp</span></code> file:
1. In the class constructor (using the initializer list), instantiate your sensor object. For example, for a joint level sensor:</p>
<blockquote>
<div><div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">Joint</span><span class="o">::</span><span class="n">Joint</span><span class="p">(</span><span class="n">config_defs</span><span class="o">::</span><span class="n">joint_id</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="kt">uint8_t</span><span class="o">*</span><span class="w"> </span><span class="n">config_to_send</span><span class="p">)</span>
<span class="w">   </span><span class="o">:</span><span class="w"> </span><span class="n">motor</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">config_to_send</span><span class="p">)</span>
<span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">controller</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">config_to_send</span><span class="p">)</span>
<span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">new_instance_of_sensor</span><span class="p">(</span><span class="n">pin_to_use</span><span class="p">)</span><span class="w">  </span><span class="c1">// Initialize the sensor instance</span>
<span class="p">{</span>
<span class="w">   </span><span class="c1">// Other initialization code...</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<ol class="arabic" start="2">
<li><p>In the method that reads sensor data, call the sensor’s <code class="docutils literal notranslate"><span class="pre">read()</span></code> function to update the system data:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">_joint_data</span><span class="o">-&gt;</span><span class="n">sensor_reading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new_instance_of_sensor</span><span class="p">.</span><span class="n">read</span><span class="p">();</span>
</pre></div>
</div>
</li>
<li><p>Similarly, call the sensor’s <code class="docutils literal notranslate"><span class="pre">calibrate()</span></code> method to update the calibration state:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">_joint_data</span><span class="o">-&gt;</span><span class="n">sensor_calibrate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new_instance_of_sensor</span><span class="p">.</span><span class="n">calibrate</span><span class="p">(</span><span class="n">_joint_data</span><span class="o">-&gt;</span><span class="n">sensor_calibrate</span><span class="p">);</span>
</pre></div>
</div>
</li>
</ol>
<p>This ensures that every time the joint (or side) runs, the sensor data is updated and, if needed, calibrated.</p>
<hr class="docutils"/>
<p>By following the above steps, you can integrate new sensors into the system. Adjust the code examples as necessary to match the specific requirements of your sensor and target hardware.</p>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="AddingNewMotorType.html" title="Adding a New Motor Type"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> "Previous" </span> Adding a New Motor Type </span>
              </div>
            </a>
          
          
            <a href="AddingNewUARTMessage.html" title="Adding New UART Messages"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> "Next" </span> Adding New UART Messages </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2025, Landon Coonrod, Jack Williams, and Prof. Zach Lerner.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>