<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Adding New Item to Config &#8212; OpenExo Documentation 0.1-dev documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=75810a84" />
    <link rel="stylesheet" type="text/css" href="_static/material.css?v=79c92029" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <script src="_static/jquery.js?v=5d32c60e"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="_static/documentation_options.js?v=4f578d93"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Adding a New Joint" href="AddingNewJoint.html" />
    <link rel="prev" title="Adding a New Error Case" href="AddingNewErrorCase.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=blue-grey data-md-color-accent=blue>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#AddingNewItemToConfig" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="index.html" title="OpenExo Documentation 0.1-dev documentation"
           class="md-header-nav__button md-logo">
          
            &nbsp;
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">OpenExo Documentation 0.1-dev documentation</span>
          <span class="md-header-nav__topic"> Adding New Item to Config </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder=""Search""
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
      
  
  <script src="_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = ""versions.json"",
        target_loc = "../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="index.html" class="md-tabs__link">OpenExo Documentation 0.1-dev documentation</a></li>
          <li class="md-tabs__item"><a href="addingelements.html" class="md-tabs__link">Adding Elements</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="index.html" title="OpenExo Documentation 0.1-dev documentation" class="md-nav__button md-logo">
      
        <img src="_static/" alt=" logo" width="48" height="48">
      
    </a>
    <a href="index.html"
       title="OpenExo Documentation 0.1-dev documentation">OpenExo Documentation 0.1-dev documentation</a>
  </label>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">"Contents"</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#addingnewitemtoconfig--page-root" class="md-nav__link">Adding New Item to Config</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#config-ini" class="md-nav__link">config.ini</a>
        </li>
        <li class="md-nav__item"><a href="#parseini-h" class="md-nav__link">ParseIni.h</a>
        </li>
        <li class="md-nav__item"><a href="#parseini-cpp" class="md-nav__link">ParseIni.cpp</a>
        </li>
        <li class="md-nav__item"><a href="#uart-commands-h" class="md-nav__link">uart_commands.h</a>
        </li>
        <li class="md-nav__item"><a href="#wrap-up" class="md-nav__link">Wrap up</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="_sources/AddingNewItemToConfig.rst.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="adding-new-item-to-config">
<h1 id="addingnewitemtoconfig--page-root">Adding New Item to Config<a class="headerlink" href="#addingnewitemtoconfig--page-root" title="Link to this heading"></a></h1>
<section id="config-ini">
<h2 id="config-ini">config.ini<a class="headerlink" href="#config-ini" title="Link to this heading"></a></h2>
<p>### Overview
- The ini file is broken into <strong>Sections</strong>, which are large categories that store data such as:</p>
<blockquote>
<div><ul class="simple">
<li><p>board, battery, or types of exoskeletons.</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p>Within sections there are <strong>Keys</strong>, which are where the actual data gets stored.
- Examples include board name, board number, and motors that are used.</p></li>
<li><p>For our specific config file, the <strong>Exo</strong> section’s key named <em>name</em> stores the type of exoskeleton that the system will use.
- This enables storing common configurations so that if we need to change the system, all that needs to be done from the code side is to change the name on the SD card and the system will configure itself correctly.</p></li>
<li><p>A semicolon (<cite>;</cite>) starts a line comment (e.g., <code class="docutils literal notranslate"><span class="pre">;</span> <span class="pre">this</span> <span class="pre">is</span> <span class="pre">a</span> <span class="pre">comment</span></code>).</p></li>
<li><p>If you are just adding new values to existing keys, ensure you update all the required locations.</p></li>
</ul>
<p>### Adding New Section
- To add a new section, simply enclose the section name in square brackets, for example, <code class="docutils literal notranslate"><span class="pre">[bluetooth]</span></code>.
- You will then need to populate it with keys.
- <strong>Note:</strong> Section names should be less than 10 characters.</p>
<p>### Adding New Keys
- Under the section, add the keys in the format <code class="docutils literal notranslate"><span class="pre">name</span> <span class="pre">=</span> <span class="pre">value</span></code> (e.g., <code class="docutils literal notranslate"><span class="pre">name</span> <span class="pre">=</span> <span class="pre">smart</span></code>).
- For each key, add a comment describing its purpose and possible values, e.g.,</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">;</span> <span class="pre">describes</span> <span class="pre">the</span> <span class="pre">type</span> <span class="pre">of</span> <span class="pre">battery</span> <span class="pre">used,</span> <span class="pre">values:</span> <span class="pre">smart</span> <span class="pre">(inspired</span> <span class="pre">energy),</span> <span class="pre">dumb</span> <span class="pre">(simple</span> <span class="pre">lipo)</span></code>.</p>
</div></blockquote>
<ul class="simple">
<li><p>If you are adding a key to an exoskeleton section (e.g., <code class="docutils literal notranslate"><span class="pre">[bilateralHipAnkle]</span></code>), be sure to add the key to all existing exoskeleton sections.</p></li>
<li><p><strong>Note:</strong> Key lengths should be less than 25 characters.</p></li>
</ul>
</section>
<section id="parseini-h">
<h2 id="parseini-h">ParseIni.h<a class="headerlink" href="#parseini-h" title="Link to this heading"></a></h2>
<ul>
<li><p><strong>namespace ini_config</strong>
- Update <code class="docutils literal notranslate"><span class="pre">number_of_keys</span></code> with the total number of keys that will be parsed.</p>
<blockquote>
<div><p><em>Example:</em> If you added 3 keys to each exoskeleton, add 3 to the existing number.</p>
</div></blockquote>
</li>
<li><p><strong>namespace config_defs</strong>
- Create an enum class to encode the key into a <code class="docutils literal notranslate"><span class="pre">uint8_t</span></code>.</p>
<blockquote>
<div><ul class="simple">
<li><p>Your key must be encoded to a <code class="docutils literal notranslate"><span class="pre">uint8_t</span></code> when passed between parts of the code.</p></li>
<li><p>Create a class with all valid key values, following the existing enum classes as a template.</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p>At the bottom of the list, add new index values for the keys you have added.
- Values should be unique and consecutive.
- As a check, confirm that the value of <code class="docutils literal notranslate"><span class="pre">number_of_keys</span></code> in <code class="docutils literal notranslate"><span class="pre">namespace</span> <span class="pre">ini_config</span></code> matches the number of indexes (which should be one more than the largest index, since we started at zero).</p></li>
</ul>
</li>
<li><p><strong>namespace config_map</strong>
- The config file will be interpreted as text. Create a map to convert the text into the <code class="docutils literal notranslate"><span class="pre">uint8_t</span></code> declared above.
- An <code class="docutils literal notranslate"><span class="pre">IniKeyCode</span></code> type is provided that is indexed with a <code class="docutils literal notranslate"><span class="pre">std::string</span></code>.</p>
<blockquote>
<div><p><em>Example:</em>
<code class="docutils literal notranslate"><span class="pre">config_map::hip_controllers["extensionAngle"]</span></code> returns <code class="docutils literal notranslate"><span class="pre">config_defs::hip_controllers::extension_angle</span></code>.</p>
</div></blockquote>
<ul class="simple">
<li><p>Create a new <code class="docutils literal notranslate"><span class="pre">IniKeyCode</span></code> for your new key (follow the others as a template).
- The string portion should include all valid values from the ini file, and the <code class="docutils literal notranslate"><span class="pre">uint8_t</span></code> should be defined in the <code class="docutils literal notranslate"><span class="pre">config_defs</span></code> namespace.</p></li>
</ul>
</li>
<li><p><strong>struct ConfigData</strong>
- This structure stores the string values during parsing.
- Create additional <code class="docutils literal notranslate"><span class="pre">std::string</span></code> fields for the new keys.</p></li>
</ul>
</section>
<section id="parseini-cpp">
<h2 id="parseini-cpp">ParseIni.cpp<a class="headerlink" href="#parseini-cpp" title="Link to this heading"></a></h2>
<ul>
<li><p>In the function <code class="docutils literal notranslate"><span class="pre">ini_parser(char*</span> <span class="pre">filename,</span> <span class="pre">uint8_t*</span> <span class="pre">config_to_send)</span></code>, you can use the existing keys as a template.</p></li>
<li><p>For each new key, there are three main steps:
1. <strong>Read the key:</strong></p>
<blockquote>
<div><p>Use
<code class="docutils literal notranslate"><span class="pre">get_section_key(filename,</span> <span class="pre">section_name,</span> <span class="pre">key_name,</span> <span class="pre">buffer,</span> <span class="pre">buffer_len)</span></code>
- This function places the value of the key into the buffer.
- If the key belongs to an exoskeleton type, then <code class="docutils literal notranslate"><span class="pre">temp_exo_name</span></code> will hold the section name (which corresponds to the appropriate exoskeleton type stored in the ini file).
- Update the section and key names in this step according to the ini file.</p>
</div></blockquote>
<ol class="arabic" start="2">
<li><p><strong>Store the value from the buffer:</strong>
- Use the corresponding field in the structure we created (<strong>ConfigData</strong>).
- The field name (<code class="docutils literal notranslate"><span class="pre">data.&lt;field&gt;</span></code>) should match the one defined in <code class="docutils literal notranslate"><span class="pre">ParseIni.h</span></code>.</p></li>
<li><p><strong>Encode the value:</strong>
- Convert the value to a <code class="docutils literal notranslate"><span class="pre">uint8_t</span></code> and place it into the configuration array using:</p>
<blockquote>
<div><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">config_to_send</span><span class="p">[</span><span class="n">config_defs</span><span class="o">::&lt;</span><span class="n">key_idx</span><span class="o">&gt;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">config_map</span><span class="o">::&lt;</span><span class="n">key_name</span><span class="o">&gt;</span><span class="p">[</span><span class="n">data</span><span class="p">.</span><span class="o">&lt;</span><span class="n">field</span><span class="o">&gt;</span><span class="p">];</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Here:
- <code class="docutils literal notranslate"><span class="pre">&lt;key_idx&gt;</span></code> is the index defined in <code class="docutils literal notranslate"><span class="pre">config_defs</span></code> (in <code class="docutils literal notranslate"><span class="pre">ParseIni.h</span></code>).
- <code class="docutils literal notranslate"><span class="pre">&lt;key_name&gt;</span></code> is the IniKeyCode name from <code class="docutils literal notranslate"><span class="pre">config_map</span></code> (in <code class="docutils literal notranslate"><span class="pre">ParseIni.h</span></code>).
- <code class="docutils literal notranslate"><span class="pre">&lt;field&gt;</span></code> is the field that was updated in step 2.</p></li>
</ul>
</div></blockquote>
</li>
</ol>
</li>
</ul>
</section>
<section id="uart-commands-h">
<h2 id="uart-commands-h">uart_commands.h<a class="headerlink" href="#uart-commands-h" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>get_config</strong>:
- Use the existing keys as a template.</p></li>
<li><p><strong>update_config</strong>:
- Use the existing keys as a template.</p></li>
</ul>
</section>
<section id="wrap-up">
<h2 id="wrap-up">Wrap up<a class="headerlink" href="#wrap-up" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>That should be everything you need to do to parse the ini file.</p></li>
<li><p>You will still need to update other parts of the code to use the new values, which depends on what you have added.</p></li>
</ul>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="AddingNewErrorCase.html" title="Adding a New Error Case"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> "Previous" </span> Adding a New Error Case </span>
              </div>
            </a>
          
          
            <a href="AddingNewJoint.html" title="Adding a New Joint"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> "Next" </span> Adding a New Joint </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2025, Landon Coonrod, Jack Williams, and Prof. Zach Lerner.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>